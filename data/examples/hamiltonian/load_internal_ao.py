#!/usr/bin/env python

from horton import *  # pylint: disable=wildcard-import,unused-wildcard-import


# Load the integrals from the file
data = IOData.from_file('hamiltonian_ao.h5')

# Access some attributes. In more realistic cases, some code follows that does a
# useful calculation.
print(data.kin.nbasis)


# CODE BELOW IS FOR horton-regression-test.py ONLY. IT IS NOT PART OF THE EXAMPLE.
import numpy as np  # pylint: disable=wrong-import-position
rt_results = {
    'kin': data.kin._array.ravel()[::10],
    'na': data.na._array.ravel()[::10],
    'er': np.einsum('aij,akl->ijkl', data.er._array, data.er._array).ravel()[::997],
    'core_energy': data.core_energy,
}
# BEGIN AUTOGENERATED CODE. DO NOT CHANGE MANUALLY.
rt_previous = {
    'core_energy': 9.1571750364299866,
    'er': np.array([
        0.89725180225471179, 0.0, 0.00033874359041040982, 0.01090112101449916, 0.0, 0.0,
        0.0, 0.036147271172379432, 0.0, 0.0040640114916747141, 0.0, 0.0,
        0.013444933423984205, 0.0028381227650030889, -0.00042795298347795066, 0.0,
        0.05130981975356564, 0.0, -0.0046360708799739131, 0.0098781829019023125, 0.0,
        0.0040668395640886985, 0.0015185846895349707, 0.0, 0.0, 0.0,
        -0.027040616303246352, 0.0, 0.0, 0.0, -0.0065386476970877043, 0.0,
        0.0081157987592952018, -0.069122886500332881, -0.021410792310862282,
        0.054399058567187117, -0.020841424187200024, 0.0, 0.0026239820872657076,
        -0.016873138877661474, 0.0, 0.0, 0.0, 0.0, 0.0, -0.017058306792934779,
        -0.004600697652327409, -0.0038418180601910556, 0.00033874359041042082, 0.0, 0.0,
        -0.0014676502653727659, 0.0, 0.0089441951700941213, 0.00094052487129774964,
        -8.8262360181099557e-20, 0.0, 0.0012055361497495703, 0.0, -0.0025159601429339891,
        0.0, 0.0, 0.0, 0.010570378077338292, -0.00012439346928733684,
        0.0011946221637041178, 0.0, 0.0029967650306810122, -0.0037040978520667435, 0.0,
        0.002604496280339682, 0.0034025398011936331, 0.00058848568106909568, 0.0,
        0.017563363847050692, 0.0, 0.0009465700526952467, 0.0, 0.0, 0.0,
        2.5159201485508032e-27, 0.0, 0.0, 0.0, 0.12174714602332004, 0.031257998409878619,
        0.0, -0.043448109696737125, 0.0, 0.0, 2.3720575472164658e-18, 0.0, 0.0,
        0.011814805717517866, 0.0, 0.0, 0.0, 0.0096528403296462541, 0.0, 0.0, 0.0,
        0.031653447273040335, 0.0, 0.0, -0.011670645846521036, 0.0, 0.026989203899261519,
        -0.0013733630822690482, -0.0013246028899376451, 0.0, -0.00385932250766926,
        0.18667539201263672, 0.0, -0.00090056337181693147, -1.2789320351518064e-18,
        0.018289494958134873, 0.013408081173179799, 0.0, 7.1583523243064581e-05,
        0.0094619252425462309, 0.0, -2.2579280128800512e-27, 0.0, 0.0,
        -0.029434885761734853, -0.0085311610610867127, -0.10522721392488943,
        -0.0061436654596083336, 0.0, -0.03918844282630083, 0.0, 0.003089131825926939,
        -1.0729144872136499e-27, 0.00031452249466716272, 0.0, 0.0, 0.0,
        -0.017058306792934779, -0.0067445266865708035, 0.0, 0.0, -0.014207855945394596,
        0.0, 0.0, 0.0, 0.21975794306849333, 0.0, 0.0, -0.048180877918008028, 0.0,
        -0.010306106655729636, 0.0, -0.021441233789480978, 0.030072793137145122,
        -0.012099393737987489, 0.0039223803077603229, -0.013319403089036707,
        -0.0079822657126292513, -6.3608156798879568e-18, 0.035547666381795767, 0.0, 0.0,
        0.0, 0.0049029052902886524, -0.25293604550018872, -0.0056538319533783162, 0.0,
        -0.036467571394448749, 0.023715887039910951, 0.014652421300649891,
        0.022016582578517199, 0.013743484354730714, 0.0, 0.0, -0.004420846485903557,
        0.015754562095667009, 0.053918402272623268, 0.029790887975944355, 0.0, 0.0,
        0.014652421300649891, 0.0, 0.0, -0.0073444670724073964, -2.3936504573251828e-29,
        0.0, 0.0, -1.3181042050251931e-28, -0.030280965269392942, -0.001040641018981648,
        0.010780067751729554, 0.0, 0.0, 0.0092903072571129675, -0.031900924150459316, 0.0,
        0.0, 0.00032665264401178702, -1.6940685144621967e-19, 0.0, 0.014319708806296978,
        0.035091373916862317, 0.0, 0.0038064511228685666, 0.012602950677423182,
        -4.300688211078124e-27, 0.0, -0.0046006976523274125, -0.010030455992492086, 0.0,
        0.0, 0.0, 0.0, 0.086681020705171516, 0.0020571840763740209, 0.0,
        0.00034502752202664113, 0.0, 0.0, 0.0086615877701873706, -0.00010229544844849651,
        0.0, 0.0, -0.012669408027262602, 0.0, -0.0013160281742988383, 0.0,
        0.0051106755973458814, 0.0, 0.0, 0.0, 0.00065776559484166718, 0.0, 0.0, 0.0, 0.0,
        0.0070298766341244934, -0.0099426911159988737, 0.095102492046631737, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.21451187351854378, -0.010323508855164837,
        -0.015768424785218515, 0.0, 0.0, 0.01988505289377469, 0.016136154963033594,
        -1.863014133554293e-06, 0.0, -0.0017646379813294408, 0.0, -0.00038519424640437477,
        0.0, 0.0, 0.16483284008403978, -0.033293363614808613, -0.036184607685237472, 0.0,
        0.0, 0.012132216313498513, -0.0036281486656409376, 0.0, 0.0,
        -0.0045419489475092036, 0.060677162850807306, 0.0, 0.036763801330999844, 0.0, 0.0,
        0.7750370389423169, 0.026239789058393363, 0.0, 0.0, -0.0060221264018631834, 0.0,
        -0.0021070052578709923, 0.006533721582747014, -0.029054135424347712, 0.0, 0.0,
        0.0, 0.0, 0.00266640244051787, 0.0, 0.0, 0.0, 0.024973062647718546,
        0.0030600664914270585, 0.0, -0.039480903355905116, -0.19300759574811735, 0.0, 0.0,
        -0.012562890882079118, 0.0, -0.054027365598984273, 0.0026239820872657055,
        0.012531626186517635, -0.0011378398426452521, 0.0, 0.0, -0.0030538804243518654,
        -0.0097786183121112511, -0.011459506074534484, 0.0, 0.0, 0.05233280757944573,
        -0.0001446041679077717, 0.0, 0.0, 0.00069368933470645195, 0.0, 0.0, 0.0, 0.0, 0.0,
        -0.00062594363466936676, 0.019564908540566448, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        -0.0032684422270475425, 0.0, -0.010750325711678417
    ]),
    'kin': np.array([
        0.96945722711242355, 0.0, 0.036292401476283279, 0.07995516390306795, 0.0,
        1.8174999999999994, 0.27452182030061434, -9.8774829880917554e-18,
        0.4858203080864158, -0.22493046394464195, 1.8174999999999994, 0.0,
        -0.0029726129513667956, 0.0, 0.018376480943548955, 10.361104211507204, 0.0,
        -0.24514942860277961, 0.0, 0.17334668011290896, 4.3248263329243191,
        7.9993407779445172e-17, 0.0, -4.6184215514858166e-17, 0.0, 4.3248263329243191,
        0.0, 0.0, 0.0, 0.27452182030061434, 0.68824999999999992, 0.093096714010858797,
        0.0, 0.0, 0.0, 4.1475000000000017, 0.0, 0.0, 0.0, 0.0, 4.1475000000000026,
        0.12248253843499435, 0.0, 0.57792718386389474, 7.9993407779445172e-17,
        4.1475000000000026, 0.0, -0.17882475033034573, 0.036292401476283279, 0.0, 0.183,
        0.34077676967706871, 0.0, -9.8774829880917554e-18, 0.093096714010858797,
        1.8174999999999994, 0.0, 0.0
    ]),
    'na': np.array([
        -6.0797251408814796, 0.0, -1.8318359795245827, -2.5150668886409582, 0.0,
        -6.061928702514308, -1.8185022809671232, 0.28314544048255308, -2.5612286623684115,
        0.14889784275391382, -5.1821395397642984, 0.0, -1.6065246363266326, 0.0,
        -2.1193055903316758, -20.636604199574929, 0.0, 3.2140498161241444,
        0.22793252967254229, -2.2275870688292225, -12.890881502223545,
        0.20355767445439643, 0.0, -0.10488028427486198, 0.0, -12.778416588080809, 0.0,
        0.0, 0.0, -1.8185022809671232, -5.4140292951278415, -0.93660650303069326, 0.0,
        0.0, 0.0, -8.4711446777306918, 0.0, 0.0, 0.0, 0.0, -8.4345065860561981,
        -0.88778762785900955, -0.069054309343865417, -2.0036653123921448,
        0.20355767445439643, -8.6284201435269861, 0.0, 0.91259495636933452,
        -1.8318359795245827, 0.0, -4.3875277704507676, -2.7053738330031201, 0.0,
        0.28314544048255308, -0.93660650303069326, -5.6021960154514723, 0.0, 0.0
    ]),
}
